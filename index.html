<html>
<head>
<title>Switch 2 Vuln Scanner UI V2</title>
</head>
<body>
<h1>Switch 2 Vuln Scanner UI V2</h1>
<p>Foolproof instructions: Click buttons to run tests—watch for crashes or leaks. Start All button gets cooking (runs everything). A ton of features added: LocalStorage, Cookie, Geolocation, Camera, Notification. Buggy on purpose (missing handles, OOB push).</p>
<button onclick="startAllTests()">Start All Tests (Get Cooking)</button>
<button onclick="testInfiniteLoop()">Test Infinite Loop (DoS CPU)</button>
<button onclick="testMemoryLeak()">Test Memory Leak (OOB Alloc)</button>
<button onclick="testFileAccess()">Test File Access (Sandbox Probe)</button>
<button onclick="testIndexedDB()">Test IndexedDB (Storage Vuln)</button>
<button onclick="testLocalStorage()">Test LocalStorage (Data Leak)</button>
<button onclick="testCookieAccess()">Test Cookie Access (Privacy Vuln)</button>
<button onclick="testGeolocation()">Test Geolocation (Location Vuln)</button>
<button onclick="testCameraAccess()">Test Camera Access (Media Vuln)</button>
<button onclick="testNotificationSpam()">Test Notification Spam (DoS Alert)</button>
<button onclick="openFileBrowser()">Open File Browser (Probe Vuln)</button>
<div id="output"></div>
<script>
function logOutput(msg) {
  document.getElementById("output").innerHTML += msg + "<br>";
}

function startAllTests() {
  logOutput("Getting cooking—running all tests...");
  testInfiniteLoop();
  testMemoryLeak();
  testFileAccess();
  testIndexedDB();
  testLocalStorage();
  testCookieAccess();
  testGeolocation();
  testCameraAccess();
  testNotificationSpam();
  openFileBrowser();
}

function testInfiniteLoop() {
  logOutput("Running infinite loop...");
  while (true) {}
}

function testMemoryLeak() {
  logOutput("Running memory leak...");
  let arr = [];
  while (true) {
    arr.push(new ArrayBuffer(1024 * 1024));
  }
}

function testFileAccess() {
  logOutput("Running file access probe...");
  let xhr = new XMLHttpRequest();
  xhr.open("GET", "file:///etc/passwd", true);
  xhr.onload = function () {
    logOutput("Leak: " + xhr.responseText);
  };
  xhr.onerror = function () {
    logOutput("File access blocked—sandbox strong");
  };
  xhr.send();
}

function testIndexedDB() {
  logOutput("Running IndexedDB probe...");
  let request = indexedDB.open("testDB", 1);
  request.onupgradeneeded = function (e) {
    e.target.result.createObjectStore("files");
  };
  request.onsuccess = function (e) {
    logOutput("DB opened—storage access OK");
  };
  request.onerror = function (e) {
    logOutput("DB error—possible vuln");
  };
}

function testLocalStorage() {
  logOutput("Running LocalStorage probe...");
  localStorage.setItem('test', 'leak me');
  let data = localStorage.getItem('test');
  logOutput("LocalStorage leak: " + data);
  localStorage.clear();
}

function testCookieAccess() {
  logOutput("Running Cookie probe...");
  document.cookie = "test=leak me";
  logOutput("Cookie leak: " + document.cookie);
}

function testGeolocation() {
  logOutput("Running Geolocation probe...");
  navigator.geolocation.getCurrentPosition(function(pos) {
    logOutput("Location leak: " + pos.coords.latitude + ", " + pos.coords.longitude);
  }, function(err) {
    logOutput("Geolocation error—possible vuln");
  });
}

function testCameraAccess() {
  logOutput("Running Camera probe...");
  navigator.mediaDevices.getUserMedia({video: true}).then(function(stream) {
    logOutput("Camera access OK—media vuln");
  }).catch(function(err) {
    logOutput("Camera error—possible vuln");
  });
}

function testNotificationSpam() {
  logOutput("Running Notification spam...");
  Notification.requestPermission().then(function(perm) {
    if (perm === "granted") {
      while (true) {
        new Notification("Spam vuln");
      }
    } else {
      logOutput("Notification denied—vuln block");
    }
  });
}

function openFileBrowser() {
  logOutput("Trying to open file browser...");
  let input = document.createElement('input');
  input.type = 'file';
  input.click();
  input.onchange = function(e) {
    logOutput("File selected: " + e.target.files[0].name);
  };
}
</script>
</body>
</html>